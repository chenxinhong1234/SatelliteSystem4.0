<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>规避和处理“太空垃圾”</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.css}" href="../../static/css/bootstrap.css"/>
    <link rel="stylesheet" th:href="@{/css/font-awesome.css}" href="../../static/css/font-awesome.css"/>
    <link rel="stylesheet" th:href="@{/css/dataTables.bootstrap.css}" href="../../static/css/dataTables.bootstrap.css"/>
    <link rel="stylesheet" th:href="@{/css/scroller.bootstrap.css}" href="../../static/css/scroller.bootstrap.css"/>
    <link rel="stylesheet" th:href="@{/css/bootstrap-datetimepicker.css}"
          href="../../static/css/bootstrap-datetimepicker.css"/>
    <link rel="stylesheet" th:href="@{/css/bootstrap-switch.css}" href="../../static/css/bootstrap-switch.css"/>

    <link rel="stylesheet" th:href="@{/css/highcharts.css}" href="../../static/css/highcharts.css"/>
    <link rel="stylesheet" th:href="@{/css/bootstrap-dialog.css}" href="../../static/css/bootstrap-dialog.css"/>

    <link rel="stylesheet" th:href="@{/css/charisma-app.css}" href="../../static/css/charisma-app.css"/>
    <link rel="stylesheet" th:href="@{/css/application.css}" href="../../static/css/application.css"/>

    <link rel="stylesheet" th:href="@{/layui/css/layui.css}" href="../../static/layui/css/layui.css"  media="all"/>
</head>
<body>
<div th:replace="layout/layout :: navbar"></div>  <!--插入layout.html中的<navbar> : 所有页面的导航栏-->

<div class="container-fluid">
    <div class="row">
        <!-- left menu starts -->
        <div th:replace="layout/layout :: menu2"></div>  <!--插入layout.html中的<menu2> :《厂内经济运行》的导航栏-->
        <!-- left menu ends -->

        <div id="content" class="col-sm-10 col-lg-10">

            <!--input starts-->
            <div class="box" style="width: 55%;float: left">
                <div class="box-inner" style="height: 100%">
                    <div class="box-header well" data-original-title="">
                        <h2><i class="glyphicon glyphicon glyphicon-edit"></i> 实时观测</h2>
                        <div class="box-icon">
                            <a href="#" class="btn btn-minimize btn-round btn-default"><i
                                    class="glyphicon glyphicon-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="box-content">
                 <!--加入视频-->
                        <video width="100%" autoplay="autoplay" controls="controls">
                            <source src="static/video/garbage.mp4" type="video/mp4"></source>
                        </video>
                        <br/>
                        <hr/>
                <!--上传图片：进行深度学习-->
                        <div class="layui-upload">
                            <button type="button" class="layui-btn layui-btn-normal" id="testList">选择在线垃圾图片</button>
                            <button type="button" class="layui-btn" id="distinguish">开始判别</button>
                            <div class="layui-upload-list">
                                <table class="layui-table">
                                    <thead>
                                    <tr><th>文件名</th>
                                        <th>大小</th>
                                        <th>状态</th>
                                        <th>操作</th>
                                    </tr></thead>
                                    <tbody id="demoList"></tbody>
                                </table>
                            </div>
                        </div>

                        <p>在线上传细胞星观测到的垃圾图片，开始深度学习，智能分析垃圾类型</p>
                    </div>
                </div>
            </div>
            <!--input ends-->

            <!--input2 starts-->
            <div class="box" style="width: 43%;float: right">
                <div class="box-inner" style="height: 100%">
                    <div class="box-header well" data-original-title="">
                        <h2><i class="glyphicon glyphicon glyphicon-edit"></i> 空间垃圾类型查询</h2>
                        <div class="box-icon">
                            <a href="#" class="btn btn-minimize btn-round btn-default"><i
                                    class="glyphicon glyphicon-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="box-content">
                        <div class="wizard" data-initialize="wizard" id="wizard">
                            <div class="container" style="width: 100%;">
                                <table id="example1" class="table table-striped table-bordered"
                                       cellspacing="0"></table>
                                <br/><hr/>
                                <table id="example2" class="table table-striped table-bordered"
                                       cellspacing="0"></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--input2 ends-->


            <!--output1 starts -->
            <div class="box" style="width: 55%;float: left;margin-bottom: 8%">
                <div class="box-inner" style="height: 100%">
                    <div class="box-header well" data-original-title="">
                        <h2><i class="glyphicon glyphicon glyphicon-list"></i> 判别结果分析</h2>
                        <div class="box-icon">
                            <a href="#" class="btn btn-minimize btn-round btn-default"><i
                                    class="glyphicon glyphicon-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="box-content">
                        <!--饼状图-->
                        <div id="container1" style="min-width:400px;height:400px"></div>
                        <div align="center">
                        <button type="button" class="layui-btn" id="suggestion">评价与建议</button>
                    </div>
                    </div>
                </div>
            </div>
            <!--output1 ends-->

            <!--output2 starts -->
            <div class="box" style="width: 43%;float: right;margin-bottom: 8%">
                <div class="box-inner" style="height: 100%">
                    <div class="box-header well" data-original-title="">
                        <h2><i class="glyphicon glyphicon glyphicon-list"></i> 规避和处理建议</h2>
                        <div class="box-icon">
                            <a href="#" class="btn btn-minimize btn-round btn-default"><i
                                    class="glyphicon glyphicon-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="box-content">
                        <div class="container2" style="width: 100%;">
                            <table id="example3" class="table table-striped table-bordered"
                                   cellspacing="0"></table>
                        </div>

                    </div>
                </div>
            </div>
            <!--output2 ends-->


        </div><!-- content ends -->
   </div><!--/row-->

</div><!--/container-fluid-->

<!--小窗口显示查询内容 -->
<!--<div id="test-window" class="easyui-window" title="文件查看"
     style="width: 65%; height: 70%;">

    <table id="file_record_table" title="提交记录" class="easyui-datagrid"
           style="width: 98%; height: auto" data-options="singleSelect:true">
        <thead>
        <tr>
            <th data-options="field:'id',align:'center',width:150">序号</th>
            <th data-options="field:'pos',align:'center',width:150">位置</th>
            <th data-options="field:'state',align:'center',width:160">状态</th>
            <th data-options="field:'time',align:'center',width:'200'">时间</th>
            <th data-options="field:'value',align:'center',width:'200'">数值</th>
        </tr>
        </thead>
    </table>
</div>-->

<div th:replace="layout/layout :: footer"></div>

<script th:src="@{/js/jquery.js}" src="../../static/js/jquery.js"></script>
<script th:src="@{/js/bootstrap.js}" src="../../static/js/bootstrap.js"></script>
<script th:src="@{/js/moment-with-locales.js}" src="../../static/js/moment-with-locales.js"></script>
<script th:src="@{/js/bootstrap-datetimepicker.js}" src="../../static/js/bootstrap-datetimepicker.js"></script>

<script th:src="@{/js/jquery.dataTables.js}" src="../../static/js/jquery.dataTables.js"></script>
<script th:src="@{/js/dataTables.bootstrap.js}" src="../../static/js/dataTables.bootstrap.js"></script>
<script th:src="@{/js/dataTables.scroller.js}" src="../../static/js/dataTables.scroller.js"></script>

<script th:src="@{/js/bootstrap-dialog.js}" src="../../static/js/bootstrap-dialog.js"></script>
<script th:src="@{/js/jquery.cookie.js}" src="../../static/js/jquery.cookie.js"></script>


<script th:src="@{/js/myChart.js}" src="../../static/js/myChart.js"></script>

<script th:src="@{/js/lodash.js}" src="../../static/js/lodash.js"></script>
<script th:src="@{/js/jquery.backstretch.js}" src="../../static/js/jquery.backstretch.js"></script>
<script th:src="@{/js/charisma.js}" src="../../static/js/charisma.js"></script>
<script th:src="@{/js/application.js}" src="../../static/js/application.js"></script>

<script src="static/layui/layui.js" charset="utf-8"></script>

<script type="text/javascript" src="../../static/tool/highcharts.js"></script>
<script type="text/javascript" src="../../static/tool/assess/exporting.js"></script>
<script type="text/javascript" src="../../static/tool/highcharts-more.js"></script>
<script type="text/javascript" src="../../static/tool/highcharts-zh_CN.js"></script>
<script>
    /*垃圾类型*/
    data1=[["1","失效的载荷与运载火箭末级","可使航天器解体，有致命危害"],
        ["2","任务相关碎片","航天表面损伤或使无保护措施部件受损"],
        ["3","解体碎片","航天表面损伤或使无保护措施部件受损"],
        ["4","失效航天器","可使航天器表面或部件损伤或整体失效"]];
    data2=[["大碎片","大于10厘米","大于1千克"],
        ["危险碎片","1毫米~10厘米","1毫克~1千克"],
        ["小碎片","小于1毫米","小于1毫克"]];

    // 垃圾类型的显现
    $('#example1').dataTable({
        data: data1,
        columns: [
            { title: "序号", sortable: false, render: function(data, type, row) { return '<a href="###">' + data + '</a>'; } },
            { title: "垃圾类型", sortable: false },
            { title: "垃圾危害", sortable: false }
            ],
        /*columns: [
            {title: "垃圾类型"},
            {title: "垃圾危害"}
        ],*/
        "language": {
            "url": "http://cdn.datatables.net/plug-ins/1.10.13/i18n/Chinese.json"
        },
        deferRender: true,
        scrollY: 400,
        scrollCollapse: true,
        scroller: true
    });
    $('#example2').dataTable({
        data: data2,
        columns: [
            {title: "碎片类型"},
            {title: "尺寸大小"},
            {title: "质量大小"}
        ],
        "language": {
            "url": "http://cdn.datatables.net/plug-ins/1.10.13/i18n/Chinese.json"
        },
        deferRender: true,
        scrollY: 400,
        scrollCollapse: true,
        scroller: true
    });

    /*var table=$("#example1").DataTable();
    //给table添加单击事件
    $('#example1 tbody').on('mouseover', 'tr', //mouseover：鼠标移上字体时。（jQuery 事件 - mouseout() 方法）
        function() {
            $(this).toggleClass('selected');
        });
    $('#example1 tbody').on('mouseout', 'tr',
        function() {
            $(this).toggleClass('selected');
        });
    $("#example1").on("click","tr",function(){//给tr或者td添加click事件
        var data=table.row(this).data();//获取值的对象数据
        console.log(data);//某一行中要是用的表头值
        alert(data);
    });*/

    /*评价与建议*/
    suggestdata=[
        ["失效航天器","变轨至运行区域以外"]
    ];

    // 建议的展示
    function suggest(){
    $('#example3').dataTable({
        data: suggestdata,
        columns: [
            {title: "判别类型"},
            {title: "规避方式"}
        ],
        "language": {
            "url": "http://cdn.datatables.net/plug-ins/1.10.13/i18n/Chinese.json"
        },
        deferRender: true,
        scrollY: 400,
        scrollCollapse: true,
        scroller: true
    });
 }

    //普通图片上传
    layui.use('upload', function(){
        var $ = layui.jquery
            ,upload = layui.upload;

        //多文件列表示例
        var demoListView = $('#demoList')
            ,uploadListIns = upload.render({
            elem: '#testList'
            ,url: '/upload/'
            ,accept: 'file'
            ,multiple: true
            ,auto: false
            /*,bindAction: '#testListAction'*/    /*去掉模板中的按钮【开始诊断】的动作，重新定一个动作*/
            ,choose: function(obj){
                var files = this.files = obj.pushFile(); //将每次选择的文件追加到文件队列
                //读取本地文件
                obj.preview(function(index, file, result){
                    var tr = $(['<tr id="upload-'+ index +'">'
                        ,'<td>'+ file.name +'</td>'
                        ,'<td>'+ (file.size/1014).toFixed(1) +'kb</td>'
                        ,'<td>等待判别</td>'
                        ,'<td>'
                        ,'<button class="layui-btn layui-btn-mini demo-reload layui-hide">重传</button>'
                        ,'<button class="layui-btn layui-btn-mini layui-btn-danger demo-delete">删除</button>'
                        ,'</td>'
                        ,'</tr>'].join(''));

                    //单个重传
                    tr.find('.demo-reload').on('click', function(){
                        obj.upload(index, file);
                    });

                    //删除
                    tr.find('.demo-delete').on('click', function(){
                        delete files[index]; //删除对应的文件
                        tr.remove();
                        uploadListIns.config.elem.next()[0].value = ''; //清空 input file 值，以免删除后出现同名文件不可选
                    });

                    demoListView.append(tr);
                });
            }
            ,done: function(res, index, upload){
                if(res.code == 0){ //上传成功
                    var tr = demoListView.find('tr#upload-'+ index)
                        ,tds = tr.children();
                    tds.eq(2).html('<span style="color: #5FB878;">上传成功</span>');
                    tds.eq(3).html(''); //清空操作
                    return delete this.files[index]; //删除文件队列已经上传成功的文件
                }
                this.error(index, upload);
            }
            ,error: function(index, upload){
                var tr = demoListView.find('tr#upload-'+ index)
                    ,tds = tr.children();
                tds.eq(2).html('<span style="color: #FF5722;">上传失败</span>');
                tds.eq(3).find('.demo-reload').removeClass('layui-hide'); //显示重传
            }
        });
    });

    /*饼状图的绘制*/
    function PieChart(){
        $('#container1').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            },
            credits: {
                enabled:false     /*去除水印*/
            },
            title: {
                text: '判别垃圾种类百分比'
            },

            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',

                    }
                }
            },
            series: [{
                type: 'pie',
                name: '判别垃圾种类百分比',
                data: [
                    ['失效的载荷与运载火箭末级',   1.4],
                    ['任务相关碎片',       2.9],
                    {
                        name: '失效航天器',
                        y: 92.2,
                        sliced: true,
                        selected: true
                    },
                    ['解体碎片',    3.5]
                ]
            }]
        });
    }

    $(function () {
        $("#distinguish").click(PieChart); // 点击【开始判别】，在下面显示饼状图
        $("#suggestion").click(suggest); // 点击【建议】，在下面显示建议

    });
</script>
</body>
</html>