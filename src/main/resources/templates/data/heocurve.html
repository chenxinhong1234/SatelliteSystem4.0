<!--预想处理曲线查询  http://127.0.0.1:8080/heocurve-->
<!DOCTYPE html>
        <html xmlns:th="http://www.thymeleaf.org">
        <head>
            <meta charset="utf-8"/>
            <meta name="viewport" content="width=device-width, initial-scale=1"/>
            <title>柘林电厂调度管理系统</title>

            <link rel="stylesheet" th:href="@{/css/bootstrap.css}" href="../../static/css/bootstrap.css"/>
            <link rel="stylesheet" th:href="@{/css/font-awesome.css}" href="../../static/css/font-awesome.css"/>
            <link rel="stylesheet" th:href="@{/css/dataTables.bootstrap.css}" href="../../static/css/dataTables.bootstrap.css"/>
            <link rel="stylesheet" th:href="@{/css/scroller.bootstrap.css}" href="../../static/css/scroller.bootstrap.css"/>

            <link rel="stylesheet" th:href="@{/css/highcharts.css}" href="../../static/css/highcharts.css"/>
            <link rel="stylesheet" th:href="@{/css/bootstrap-dialog.css}" href="../../static/css/bootstrap-dialog.css"/>

            <link rel="stylesheet" th:href="@{/css/charisma-app.css}" href="../../static/css/charisma-app.css"/>
            <link rel="stylesheet" th:href="@{/css/application.css}" href="../../static/css/application.css"/>

        </head>
<body>

<div th:replace="layout/layout :: navbar"></div>
<div class="container-fluid">
    <!-- left menu starts -->
    <div th:replace="layout/layout :: menu1"></div>
    <!-- left menu ends -->
    <div class="box col-md-10">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <form>
                        <div class="form-group">
                            <label  >选择机组类型:</label>
                            <select class="form-control" id="selectUnit">
                                <option id="unit1" value="unit1">机组类型1（1-4号机组）</option>
                                <option id="unit2" value="unit2">机组类型2（5-6号机组）</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="value">根据水头查询预想出力:</label>
                        <input type="text" class="form-control" id="value" placeholder="请输入机组水头(m)"/>
                    </div>
                    <!-- 按钮触发模态框 -->
                    <button class="btn btn-primary" data-toggle="modal" data-target="#myModal" id="find">
                        查询
                    </button>
                </div>
            </div>
        </div>
        <div class="container">
            <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%"></table>
        </div>

        <div class="container">
            <div id="container" style="height: 400px; margin: 0 auto"></div>
        </div>
    </div>
</div>
<div th:replace="layout/layout :: footer"></div>

<script th:src="@{/js/jquery.js}" src="../../static/js/jquery.js"></script>
<script th:src="@{/js/bootstrap.js}" src="../../static/js/bootstrap.js"></script>
<script th:src="@{/js/moment-with-locales.js}" src="../../static/js/moment-with-locales.js"></script>
<script th:src="@{/js/bootstrap-datetimepicker.js}" src="../../static/js/bootstrap-datetimepicker.js"></script>

<script th:src="@{/js/jquery.dataTables.js}" src="../../static/js/jquery.dataTables.js"></script>
<script th:src="@{/js/dataTables.bootstrap.js}" src="../../static/js/dataTables.bootstrap.js"></script>
<script th:src="@{/js/dataTables.scroller.js}" src="../../static/js/dataTables.scroller.js"></script>

<script th:src="@{/js/bootstrap-dialog.js}" src="../../static/js/bootstrap-dialog.js"></script>
<script th:src="@{/js/jquery.cookie.js}" src="../../static/js/jquery.cookie.js"></script>

<script th:src="@{/js/highcharts.src.js}" src="../../static/js/highcharts.src.js"></script>
<script th:src="@{/js/exporting.src.js}" src="../../static/js/exporting.src.js"></script>
<script th:src="@{/js/myChart.js}" src="../../static/js/myChart.js"></script>

<script th:src="@{/js/lodash.js}" src="../../static/js/lodash.js"></script>
<script th:src="@{/js/jquery.backstretch.js}" src="../../static/js/jquery.backstretch.js"></script>
<script th:src="@{/js/charisma.js}" src="../../static/js/charisma.js"></script>
<script th:src="@{/js/application.js}" src="../../static/js/application.js"></script>
<script>

    $(function () {
        var search = {};
        search.pattern = "unit1";

        //提交选择的机组类型,请求数据【待会再复用代码吧，先实现功能再说。。。】
        $.ajax({
            type: "POST",
            contentType: "application/json",
            url: "/data/heo",
            data: JSON.stringify(search),
            dataType: 'json',
            timeout: 100000,
            success: function (data) {



                // dataTables
                $('#example').dataTable({
                    data: data,
                    columns: [
                        {title: "水头(m)"},
                        {title: "预想出力(MW)"}
                    ],
                    "language": {
                        "url": "http://cdn.datatables.net/plug-ins/1.10.13/i18n/Chinese.json"
                    },
                    deferRender: true,
                    scrollY: 400,
                    scrollCollapse: true,
                    scroller: true,
                    bDestroy: true
                });

                // Highcharts
                var chartOption = {
                    id: "container",
                    title: "预想出力曲线",
                    xAxis: "水头(m)",
                    yAxis: "预想出力(MW)"
                };

                drawChart(chartOption, data);
            }



        });

//选择机组类型触发事件
        $('#selectUnit').change(function(){

                search.pattern = $("#selectUnit").val();
//提交选择的机组类型,请求数据
            $.ajax({
                type: "POST",
                contentType: "application/json",
                url: "/data/heo",
                data: JSON.stringify(search),
                dataType: 'json',
                timeout: 100000,
                success: function (data) {



                    // dataTables
                    $('#example').dataTable({
                        data: data,
                        columns: [
                            {title: "水头"},
                            {title: "预想出力"}
                        ],
                        "language": {
                            "url": "http://cdn.datatables.net/plug-ins/1.10.13/i18n/Chinese.json"
                        },
                        deferRender: true,
                        scrollY: 400,
                        scrollCollapse: true,
                        scroller: true,
                        bDestroy: true
                    });

                    // Highcharts
                    var chartOption = {
                        id: "container",
                        title: "预想出力曲线",
                        xAxis: "水位(m)",
                        yAxis: "预想出力(MW)"
                    };

                    drawChart(chartOption, data);
                }



            });

        });

    });

</script>
<script>
    $(function () {
        $("#find").click(function () {
            var search = {};
            search.pattern = $("#selectUnit").val();
            search.value = $("#value").val();
//            alert(search.pattern );
            $.ajax({
                type: "POST",
                contentType: "application/json",
                url: "/data/searchHeo",
                data: JSON.stringify(search),
                dataType: 'json',
                timeout: 100000,
                success: function (data) {
                    BootstrapDialog.alert({
                        type:'type-success',
                        title:'预想出力为：',
                        message:data.toFixed(2)+"MW"
                    });
                },
                error: function () {
                    BootstrapDialog.alert({
                        type:'type-danger',
                        title:'错误提示：',
                        message:"请输入正确参数范围!"
                    });
                }
            });
        });
    });
</script>
</body>
</html>
