<!--水位库容曲线查询  http://127.0.0.1:8080/zvcurve-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>柘林电厂调度管理系统</title>

    <link rel="stylesheet" th:href="@{/css/bootstrap.css}" href="../../static/css/bootstrap.css"/>
    <link rel="stylesheet" th:href="@{/css/font-awesome.css}" href="../../static/css/font-awesome.css"/>
    <link rel="stylesheet" th:href="@{/css/dataTables.bootstrap.css}" href="../../static/css/dataTables.bootstrap.css"/>
    <link rel="stylesheet" th:href="@{/css/scroller.bootstrap.css}" href="../../static/css/scroller.bootstrap.css"/>

    <link rel="stylesheet" th:href="@{/css/highcharts.css}" href="../../static/css/highcharts.css"/>
    <link rel="stylesheet" th:href="@{/css/bootstrap-dialog.css}" href="../../static/css/bootstrap-dialog.css"/>

    <link rel="stylesheet" th:href="@{/css/charisma-app.css}" href="../../static/css/charisma-app.css"/>
    <link rel="stylesheet" th:href="@{/css/application.css}" href="../../static/css/application.css"/>

</head>
<body>
<!--插入《layout》中的导航栏<navbar>-->
<div th:replace="layout/layout :: navbar"></div>


<div class="container-fluid">
    <div class="row">
        <!-- left menu starts -->
          <!--插入《layout》中的导航栏<menu1>-->
        <div th:replace="layout/layout :: menu1"></div>
        <!-- left menu ends -->
      <div class="box col-md-10">
         <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <form>
                        <div class="form-group">
                            <label for="interpolate">选择查询方法:</label>
                            <select class="form-control" id="interpolate">
                                <option value="zv">根据水位查询库容</option>
                                <option value="vz">根据库容查询水位</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label >输入查询参数:</label>
                        <input type="text" class="form-control" id="searchValue" placeholder="请输入水位(m)"/>
                    </div>
                    <!-- 按钮触发模态框 -->
                    <button class="btn btn-primary" data-toggle="modal" data-target="#myModal" id="inter">
                        插值
                    </button>
                </div>
            </div>
         </div>

         <div class="container">
             <!--搜索结果区域（文字）-->
            <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%"></table>
         </div>
         <!--画图区域-->
         <div class="container">
            <div id="container" style="height: 400px; margin: 0 auto"></div>
         </div>
      </div>
    </div>
</div>
<!--插入《layout》中的底部导航栏<footer>-->
<div th:replace="layout/layout :: footer"></div>

<script th:src="@{/js/jquery.js}" src="../../static/js/jquery.js"></script>
<script th:src="@{/js/bootstrap.js}" src="../../static/js/bootstrap.js"></script>
<script th:src="@{/js/moment-with-locales.js}" src="../../static/js/moment-with-locales.js"></script>
<script th:src="@{/js/bootstrap-datetimepicker.js}" src="../../static/js/bootstrap-datetimepicker.js"></script>

<script th:src="@{/js/jquery.dataTables.js}" src="../../static/js/jquery.dataTables.js"></script>
<script th:src="@{/js/dataTables.bootstrap.js}" src="../../static/js/dataTables.bootstrap.js"></script>
<script th:src="@{/js/dataTables.scroller.js}" src="../../static/js/dataTables.scroller.js"></script>

<script th:src="@{/js/bootstrap-dialog.js}" src="../../static/js/bootstrap-dialog.js"></script>
<script th:src="@{/js/jquery.cookie.js}" src="../../static/js/jquery.cookie.js"></script>

<script th:src="@{/js/highcharts.src.js}" src="../../static/js/highcharts.src.js"></script>
<script th:src="@{/js/exporting.src.js}" src="../../static/js/exporting.src.js"></script>
<script th:src="@{/js/myChart.js}" src="../../static/js/myChart.js"></script>

<script th:src="@{/js/lodash.js}" src="../../static/js/lodash.js"></script>
<script th:src="@{/js/jquery.backstretch.js}" src="../../static/js/jquery.backstretch.js"></script>
<script th:src="@{/js/charisma.js}" src="../../static/js/charisma.js"></script>
<script th:src="@{/js/application.js}" src="../../static/js/application.js"></script>
<script>
    /*[选择方法]和[选择查询参数]的事件*/
    $(function () {
        var search = {};
        search.pattern = "zv";             /* 初始化的时候，页面显示的是zv：根据水位查询库容*/
        $('#interpolate').change(function(){
            search.pattern = $("#interpolate").val();
            if(search.pattern =="zv"){          /* zv：根据水位查询库容，vz: 根据库容查询水位*/
                $("#searchValue").attr('placeholder','请输入水位(m)')
            }
            else {
                $("#searchValue").attr('placeholder','请输入库容(万m³)')
            }

        });

        $.getJSON('/data/zv', function (data) {   /*映射到ZvController中的zv方法中（"/zv"），执行方法，调出数据*/
            // dataTables
            /*搜索结果显示部分（文字）*/
            $('#example').dataTable({
                data: data,
                columns: [
                    {title: "水位(m)"},
                    {title: "库容(万m³)"}
                ],
                "language": {
                    "url": "http://cdn.datatables.net/plug-ins/1.10.13/i18n/Chinese.json"
                },
                deferRender: true,
                scrollY: 400,
                scrollCollapse: true,
                scroller: true
            });

            // Highcharts
            /*搜索结果显示部分（图像）*/
            var chartOption = {
                id: "container",
                title: "水位库容关系曲线",
                xAxis: "水位(m)",
                yAxis: "库容(万m³)"
            };
            drawChart(chartOption, data);
        });
    });

</script>
<script>
   /*按钮【插值】的事件，将输入进去的数值，传到指定地址，然后返回一个跳出窗口，上面显示插值的结果即输入某水位返回某库容*/
    $(function () {
        $("#inter").click(function () {
            var search = {};
            search.pattern = $("#interpolate").val();
            search.value = $("#searchValue").val();

            $.ajax({
                type: "POST",
                contentType: "application/json",
                url: "/data/i nter",
                data: JSON.stringify(search),
                dataType: 'json',
                timeout: 100000,
                success: function (data) {
                    BootstrapDialog.alert({
                        title:'插值结果为：',
                        type:'type-success',
                        message:data.toFixed(2)
                    });
                },
                error: function () {
                    BootstrapDialog.alert({
                        type:'type-danger',
                        title:'错误提示：',
                        message:"请输入正确参数范围!"
                    });
                }
            });
        });
    });
</script>
</body>
</html>
